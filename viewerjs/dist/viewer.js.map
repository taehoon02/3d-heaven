{"version":3,"file":"viewer.js","sources":["../src/js/defaults.js","../src/js/template.js","../src/js/constants.js","../src/js/utilities.js","../src/js/render.js","../src/js/events.js","../src/js/handlers.js","../src/js/methods.js","../src/js/others.js","../src/js/viewer.js"],"sourcesContent":["export default {\n  // Enable inline mode\n  inline: false,\n\n  // Show the button on the top-right of the viewer\n  button: true,\n\n  // Show the navbar\n  navbar: true,\n\n  // Show the title\n  title: true,\n\n  // Show the toolbar\n  toolbar: true,\n\n  // Show the tooltip with image ratio (percentage) when zoom in or zoom out\n  tooltip: true,\n\n  // Enable to move the image\n  movable: true,\n\n  // Enable to zoom the image\n  zoomable: true,\n\n  // Enable to rotate the image\n  rotatable: true,\n\n  // Enable to scale the image\n  scalable: true,\n\n  // Enable CSS3 Transition for some special elements\n  transition: true,\n\n  // Enable to request fullscreen when play\n  fullscreen: true,\n\n  // The amount of time to delay between automatically cycling an image when playing.\n  interval: 5000,\n\n  // Enable keyboard support\n  keyboard: true,\n\n  // Enable a modal backdrop, specify `static` for a backdrop which doesn't close the modal on click\n  backdrop: true,\n\n  // Indicate if show a loading spinner when load image or not.\n  loading: true,\n\n  // Indicate if enable loop viewing or not.\n  loop: true,\n\n  // Min width of the viewer in inline mode\n  minWidth: 200,\n\n  // Min height of the viewer in inline mode\n  minHeight: 100,\n\n  // Define the ratio when zoom the image by wheeling mouse\n  zoomRatio: 0.1,\n\n  // Define the min ratio of the image when zoom out\n  minZoomRatio: 0.01,\n\n  // Define the max ratio of the image when zoom in\n  maxZoomRatio: 100,\n\n  // Define the CSS `z-index` value of viewer in modal mode.\n  zIndex: 2015,\n\n  // Define the CSS `z-index` value of viewer in inline mode.\n  zIndexInline: 0,\n\n  // Define where to get the original image URL for viewing\n  // Type: String (an image attribute) or Function (should return an image URL)\n  url: 'src',\n\n  // Define where to put the viewer in modal mode.\n  // Type: String | Element\n  container: 'body',\n\n  // Filter the images for viewing.\n  // Type: Function (return true if the image is viewable)\n  filter: null,\n\n  // Event shortcuts\n  ready: null,\n  show: null,\n  shown: null,\n  hide: null,\n  hidden: null,\n  view: null,\n  viewed: null,\n  zoom: null,\n  zoomed: null,\n};\n","export default (\n  '<div class=\"viewer-container\" touch-action=\"none\">' +\n    '<div class=\"viewer-canvas\"></div>' +\n    '<div class=\"viewer-footer\">' +\n      '<div class=\"viewer-title\"></div>' +\n      '<div class=\"viewer-toolbar\"></div>' +\n      '<div class=\"viewer-navbar\">' +\n        '<ul class=\"viewer-list\"></ul>' +\n      '</div>' +\n    '</div>' +\n    '<div class=\"viewer-tooltip\"></div>' +\n    '<div role=\"button\" class=\"viewer-button\" data-viewer-action=\"mix\"></div>' +\n    '<div class=\"viewer-player\"></div>' +\n  '</div>'\n);\n","export const IN_BROWSER = typeof window !== 'undefined';\nexport const WINDOW = IN_BROWSER ? window : {};\nexport const NAMESPACE = 'viewer';\n\n// Actions\nexport const ACTION_MOVE = 'move';\nexport const ACTION_SWITCH = 'switch';\nexport const ACTION_ZOOM = 'zoom';\n\n// Classes\nexport const CLASS_ACTIVE = `${NAMESPACE}-active`;\nexport const CLASS_CLOSE = `${NAMESPACE}-close`;\nexport const CLASS_FADE = `${NAMESPACE}-fade`;\nexport const CLASS_FIXED = `${NAMESPACE}-fixed`;\nexport const CLASS_FULLSCREEN = `${NAMESPACE}-fullscreen`;\nexport const CLASS_FULLSCREEN_EXIT = `${NAMESPACE}-fullscreen-exit`;\nexport const CLASS_HIDE = `${NAMESPACE}-hide`;\nexport const CLASS_HIDE_MD_DOWN = `${NAMESPACE}-hide-md-down`;\nexport const CLASS_HIDE_SM_DOWN = `${NAMESPACE}-hide-sm-down`;\nexport const CLASS_HIDE_XS_DOWN = `${NAMESPACE}-hide-xs-down`;\nexport const CLASS_IN = `${NAMESPACE}-in`;\nexport const CLASS_INVISIBLE = `${NAMESPACE}-invisible`;\nexport const CLASS_LOADING = `${NAMESPACE}-loading`;\nexport const CLASS_MOVE = `${NAMESPACE}-move`;\nexport const CLASS_OPEN = `${NAMESPACE}-open`;\nexport const CLASS_SHOW = `${NAMESPACE}-show`;\nexport const CLASS_TRANSITION = `${NAMESPACE}-transition`;\n\n// Events\nexport const EVENT_READY = 'ready';\nexport const EVENT_SHOW = 'show';\nexport const EVENT_SHOWN = 'shown';\nexport const EVENT_HIDE = 'hide';\nexport const EVENT_HIDDEN = 'hidden';\nexport const EVENT_VIEW = 'view';\nexport const EVENT_VIEWED = 'viewed';\nexport const EVENT_ZOOM = 'zoom';\nexport const EVENT_ZOOMED = 'zoomed';\nexport const EVENT_CLICK = 'click';\nexport const EVENT_DRAG_START = 'dragstart';\nexport const EVENT_KEY_DOWN = 'keydown';\nexport const EVENT_LOAD = 'load';\nexport const EVENT_POINTER_DOWN = WINDOW.PointerEvent ? 'pointerdown' : 'touchstart mousedown';\nexport const EVENT_POINTER_MOVE = WINDOW.PointerEvent ? 'pointermove' : 'touchmove mousemove';\nexport const EVENT_POINTER_UP = WINDOW.PointerEvent ? 'pointerup pointercancel' : 'touchend touchcancel mouseup';\nexport const EVENT_RESIZE = 'resize';\nexport const EVENT_TRANSITION_END = 'transitionend';\nexport const EVENT_WHEEL = 'wheel mousewheel DOMMouseScroll';\n\n// Data keys\nexport const DATA_ACTION = `${NAMESPACE}Action`;\nexport const BUTTONS = [\n  'zoom-in',\n  'zoom-out',\n  'one-to-one',\n  'reset',\n  'prev',\n  'play',\n  'next',\n  'rotate-left',\n  'rotate-right',\n  'flip-horizontal',\n  'flip-vertical',\n];\n","import {\n  CLASS_HIDE_MD_DOWN,\n  CLASS_HIDE_SM_DOWN,\n  CLASS_HIDE_XS_DOWN,\n  IN_BROWSER,\n  WINDOW,\n} from './constants';\n\n/**\n * Check if the given value is a string.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n */\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Check if the given value is not a number.\n */\nexport const isNaN = Number.isNaN || WINDOW.isNaN;\n\n/**\n * Check if the given value is a number.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n */\nexport function isNumber(value) {\n  return typeof value === 'number' && !isNaN(value);\n}\n\n/**\n * Check if the given value is undefined.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n */\nexport function isUndefined(value) {\n  return typeof value === 'undefined';\n}\n\n/**\n * Check if the given value is an object.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n */\nexport function isObject(value) {\n  return typeof value === 'object' && value !== null;\n}\n\nconst { hasOwnProperty } = Object.prototype;\n\n/**\n * Check if the given value is a plain object.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n */\nexport function isPlainObject(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n\n  try {\n    const { constructor } = value;\n    const { prototype } = constructor;\n\n    return constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Check if the given value is a function.\n * @param {*} value - The value to check.\n * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n */\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Iterate the given data.\n * @param {*} data - The data to iterate.\n * @param {Function} callback - The process function for each element.\n * @returns {*} The original data.\n */\nexport function forEach(data, callback) {\n  if (data && isFunction(callback)) {\n    if (Array.isArray(data) || isNumber(data.length)/* array-like */) {\n      const { length } = data;\n      let i;\n\n      for (i = 0; i < length; i += 1) {\n        if (callback.call(data, data[i], i, data) === false) {\n          break;\n        }\n      }\n    } else if (isObject(data)) {\n      Object.keys(data).forEach((key) => {\n        callback.call(data, data[key], key, data);\n      });\n    }\n  }\n\n  return data;\n}\n\n/**\n * Extend the given object.\n * @param {*} obj - The object to be extended.\n * @param {*} args - The rest objects which will be merged to the first object.\n * @returns {Object} The extended object.\n */\nexport const assign = Object.assign || function assign(obj, ...args) {\n  if (isObject(obj) && args.length > 0) {\n    args.forEach((arg) => {\n      if (isObject(arg)) {\n        Object.keys(arg).forEach((key) => {\n          obj[key] = arg[key];\n        });\n      }\n    });\n  }\n\n  return obj;\n};\n\nconst REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n\n/**\n * Apply styles to the given element.\n * @param {Element} element - The target element.\n * @param {Object} styles - The styles for applying.\n */\nexport function setStyle(element, styles) {\n  const { style } = element;\n\n  forEach(styles, (value, property) => {\n    if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n      value += 'px';\n    }\n\n    style[property] = value;\n  });\n}\n\n/**\n * Check if the given element has a special class.\n * @param {Element} element - The element to check.\n * @param {string} value - The class to search.\n * @returns {boolean} Returns `true` if the special class was found.\n */\nexport function hasClass(element, value) {\n  return element.classList ?\n    element.classList.contains(value) :\n    element.className.indexOf(value) > -1;\n}\n\n/**\n * Add classes to the given element.\n * @param {Element} element - The target element.\n * @param {string} value - The classes to be added.\n */\nexport function addClass(element, value) {\n  if (!value) {\n    return;\n  }\n\n  if (isNumber(element.length)) {\n    forEach(element, (elem) => {\n      addClass(elem, value);\n    });\n    return;\n  }\n\n  if (element.classList) {\n    element.classList.add(value);\n    return;\n  }\n\n  const className = element.className.trim();\n\n  if (!className) {\n    element.className = value;\n  } else if (className.indexOf(value) < 0) {\n    element.className = `${className} ${value}`;\n  }\n}\n\n/**\n * Remove classes from the given element.\n * @param {Element} element - The target element.\n * @param {string} value - The classes to be removed.\n */\nexport function removeClass(element, value) {\n  if (!value) {\n    return;\n  }\n\n  if (isNumber(element.length)) {\n    forEach(element, (elem) => {\n      removeClass(elem, value);\n    });\n    return;\n  }\n\n  if (element.classList) {\n    element.classList.remove(value);\n    return;\n  }\n\n  if (element.className.indexOf(value) >= 0) {\n    element.className = element.className.replace(value, '');\n  }\n}\n\n/**\n * Add or remove classes from the given element.\n * @param {Element} element - The target element.\n * @param {string} value - The classes to be toggled.\n * @param {boolean} added - Add only.\n */\nexport function toggleClass(element, value, added) {\n  if (!value) {\n    return;\n  }\n\n  if (isNumber(element.length)) {\n    forEach(element, (elem) => {\n      toggleClass(elem, value, added);\n    });\n    return;\n  }\n\n  // IE10-11 doesn't support the second parameter of `classList.toggle`\n  if (added) {\n    addClass(element, value);\n  } else {\n    removeClass(element, value);\n  }\n}\n\nconst REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n\n/**\n * Transform the given string from camelCase to kebab-case\n * @param {string} value - The value to transform.\n * @returns {string} The transformed value.\n */\nexport function hyphenate(value) {\n  return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n}\n\n/**\n * Get data from the given element.\n * @param {Element} element - The target element.\n * @param {string} name - The data key to get.\n * @returns {string} The data value.\n */\nexport function getData(element, name) {\n  if (isObject(element[name])) {\n    return element[name];\n  } else if (element.dataset) {\n    return element.dataset[name];\n  }\n\n  return element.getAttribute(`data-${hyphenate(name)}`);\n}\n\n/**\n * Set data to the given element.\n * @param {Element} element - The target element.\n * @param {string} name - The data key to set.\n * @param {string} data - The data value.\n */\nexport function setData(element, name, data) {\n  if (isObject(data)) {\n    element[name] = data;\n  } else if (element.dataset) {\n    element.dataset[name] = data;\n  } else {\n    element.setAttribute(`data-${hyphenate(name)}`, data);\n  }\n}\n\n/**\n * Remove data from the given element.\n * @param {Element} element - The target element.\n * @param {string} name - The data key to remove.\n */\nexport function removeData(element, name) {\n  if (isObject(element[name])) {\n    try {\n      delete element[name];\n    } catch (e) {\n      element[name] = undefined;\n    }\n  } else if (element.dataset) {\n    // #128 Safari not allows to delete dataset property\n    try {\n      delete element.dataset[name];\n    } catch (e) {\n      element.dataset[name] = undefined;\n    }\n  } else {\n    element.removeAttribute(`data-${hyphenate(name)}`);\n  }\n}\n\nconst REGEXP_SPACES = /\\s\\s*/;\nconst onceSupported = (() => {\n  let supported = false;\n\n  if (IN_BROWSER) {\n    let once = false;\n    const listener = () => {};\n    const options = Object.defineProperty({}, 'once', {\n      get() {\n        supported = true;\n        return once;\n      },\n\n      /**\n       * This setter can fix a `TypeError` in strict mode\n       * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n       * @param {boolean} value - The value to set\n       */\n      set(value) {\n        once = value;\n      },\n    });\n\n    WINDOW.addEventListener('test', listener, options);\n    WINDOW.removeEventListener('test', listener, options);\n  }\n\n  return supported;\n})();\n\n/**\n * Remove event listener from the target element.\n * @param {Element} element - The event target.\n * @param {string} type - The event type(s).\n * @param {Function} listener - The event listener.\n * @param {Object} options - The event options.\n */\nexport function removeListener(element, type, listener, options = {}) {\n  let handler = listener;\n\n  type.trim().split(REGEXP_SPACES).forEach((event) => {\n    if (!onceSupported) {\n      const { listeners } = element;\n\n      if (listeners && listeners[event] && listeners[event][listener]) {\n        handler = listeners[event][listener];\n        delete listeners[event][listener];\n\n        if (Object.keys(listeners[event]).length === 0) {\n          delete listeners[event];\n        }\n\n        if (Object.keys(listeners).length === 0) {\n          delete element.listeners;\n        }\n      }\n    }\n\n    element.removeEventListener(event, handler, options);\n  });\n}\n\n/**\n * Add event listener to the target element.\n * @param {Element} element - The event target.\n * @param {string} type - The event type(s).\n * @param {Function} listener - The event listener.\n * @param {Object} options - The event options.\n */\nexport function addListener(element, type, listener, options = {}) {\n  let handler = listener;\n\n  type.trim().split(REGEXP_SPACES).forEach((event) => {\n    if (options.once && !onceSupported) {\n      const { listeners = {} } = element;\n\n      handler = (...args) => {\n        delete listeners[event][listener];\n        element.removeEventListener(event, handler, options);\n        listener.apply(element, args);\n      };\n\n      if (!listeners[event]) {\n        listeners[event] = {};\n      }\n\n      if (listeners[event][listener]) {\n        element.removeEventListener(event, listeners[event][listener], options);\n      }\n\n      listeners[event][listener] = handler;\n      element.listeners = listeners;\n    }\n\n    element.addEventListener(event, handler, options);\n  });\n}\n\n/**\n * Dispatch event on the target element.\n * @param {Element} element - The event target.\n * @param {string} type - The event type(s).\n * @param {Object} data - The additional event data.\n * @returns {boolean} Indicate if the event is default prevented or not.\n */\nexport function dispatchEvent(element, type, data) {\n  let event;\n\n  // Event and CustomEvent on IE9-11 are global objects, not constructors\n  if (isFunction(Event) && isFunction(CustomEvent)) {\n    event = new CustomEvent(type, {\n      detail: data,\n      bubbles: true,\n      cancelable: true,\n    });\n  } else {\n    event = document.createEvent('CustomEvent');\n    event.initCustomEvent(type, true, true, data);\n  }\n\n  return element.dispatchEvent(event);\n}\n\n/**\n * Get the offset base on the document.\n * @param {Element} element - The target element.\n * @returns {Object} The offset data.\n */\nexport function getOffset(element) {\n  const box = element.getBoundingClientRect();\n\n  return {\n    left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n    top: box.top + (window.pageYOffset - document.documentElement.clientTop),\n  };\n}\n\n/**\n * Get transforms base on the given object.\n * @param {Object} obj - The target object.\n * @returns {string} A string contains transform values.\n */\nexport function getTransforms({\n  rotate,\n  scaleX,\n  scaleY,\n  translateX,\n  translateY,\n}) {\n  const values = [];\n\n  if (isNumber(translateX) && translateX !== 0) {\n    values.push(`translateX(${translateX}px)`);\n  }\n\n  if (isNumber(translateY) && translateY !== 0) {\n    values.push(`translateY(${translateY}px)`);\n  }\n\n  // Rotate should come first before scale to match orientation transform\n  if (isNumber(rotate) && rotate !== 0) {\n    values.push(`rotate(${rotate}deg)`);\n  }\n\n  if (isNumber(scaleX) && scaleX !== 1) {\n    values.push(`scaleX(${scaleX})`);\n  }\n\n  if (isNumber(scaleY) && scaleY !== 1) {\n    values.push(`scaleY(${scaleY})`);\n  }\n\n  const transform = values.length ? values.join(' ') : 'none';\n\n  return {\n    WebkitTransform: transform,\n    msTransform: transform,\n    transform,\n  };\n}\n\n/**\n * Get an image name from an image url.\n * @param {string} url - The target url.\n * @example\n * // picture.jpg\n * getImageNameFromURL('http://domain.com/path/to/picture.jpg?size=1280×960')\n * @returns {string} A string contains the image name.\n */\nexport function getImageNameFromURL(url) {\n  return isString(url) ? url.replace(/^.*\\//, '').replace(/[?&#].*$/, '') : '';\n}\n\nconst IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n\n/**\n * Get an image's natural sizes.\n * @param {string} image - The target image.\n * @param {Function} callback - The callback function.\n * @returns {HTMLImageElement} The new image.\n */\nexport function getImageNaturalSizes(image, callback) {\n  const newImage = document.createElement('img');\n\n  // Modern browsers (except Safari)\n  if (image.naturalWidth && !IS_SAFARI) {\n    callback(image.naturalWidth, image.naturalHeight);\n    return newImage;\n  }\n\n  const body = document.body || document.documentElement;\n\n  newImage.onload = () => {\n    callback(newImage.width, newImage.height);\n\n    if (!IS_SAFARI) {\n      body.removeChild(newImage);\n    }\n  };\n\n  newImage.src = image.src;\n\n  // iOS Safari will convert the image automatically\n  // with its orientation once append it into DOM\n  if (!IS_SAFARI) {\n    newImage.style.cssText = (\n      'left:0;' +\n      'max-height:none!important;' +\n      'max-width:none!important;' +\n      'min-height:0!important;' +\n      'min-width:0!important;' +\n      'opacity:0;' +\n      'position:absolute;' +\n      'top:0;' +\n      'z-index:-1;'\n    );\n    body.appendChild(newImage);\n  }\n\n  return newImage;\n}\n\n/**\n * Get the related class name of a responsive type number.\n * @param {string} type - The responsive type.\n * @returns {string} The related class name.\n */\nexport function getResponsiveClass(type) {\n  switch (type) {\n    case 2:\n      return CLASS_HIDE_XS_DOWN;\n\n    case 3:\n      return CLASS_HIDE_SM_DOWN;\n\n    case 4:\n      return CLASS_HIDE_MD_DOWN;\n\n    default:\n      return '';\n  }\n}\n\n/**\n * Get the max ratio of a group of pointers.\n * @param {string} pointers - The target pointers.\n * @returns {number} The result ratio.\n */\nexport function getMaxZoomRatio(pointers) {\n  const pointers2 = assign({}, pointers);\n  const ratios = [];\n\n  forEach(pointers, (pointer, pointerId) => {\n    delete pointers2[pointerId];\n\n    forEach(pointers2, (pointer2) => {\n      const x1 = Math.abs(pointer.startX - pointer2.startX);\n      const y1 = Math.abs(pointer.startY - pointer2.startY);\n      const x2 = Math.abs(pointer.endX - pointer2.endX);\n      const y2 = Math.abs(pointer.endY - pointer2.endY);\n      const z1 = Math.sqrt((x1 * x1) + (y1 * y1));\n      const z2 = Math.sqrt((x2 * x2) + (y2 * y2));\n      const ratio = (z2 - z1) / z1;\n\n      ratios.push(ratio);\n    });\n  });\n\n  ratios.sort((a, b) => Math.abs(a) < Math.abs(b));\n\n  return ratios[0];\n}\n\n/**\n * Get a pointer from an event object.\n * @param {Object} event - The target event object.\n * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n * @returns {Object} The result pointer contains start and/or end point coordinates.\n */\nexport function getPointer({ pageX, pageY }, endOnly) {\n  const end = {\n    endX: pageX,\n    endY: pageY,\n  };\n\n  return endOnly ? end : assign({\n    startX: pageX,\n    startY: pageY,\n  }, end);\n}\n\n/**\n * Get the center point coordinate of a group of pointers.\n * @param {Object} pointers - The target pointers.\n * @returns {Object} The center point coordinate.\n */\nexport function getPointersCenter(pointers) {\n  let pageX = 0;\n  let pageY = 0;\n  let count = 0;\n\n  forEach(pointers, ({ startX, startY }) => {\n    pageX += startX;\n    pageY += startY;\n    count += 1;\n  });\n\n  pageX /= count;\n  pageY /= count;\n\n  return {\n    pageX,\n    pageY,\n  };\n}\n","import {\n  CLASS_LOADING,\n  CLASS_TRANSITION,\n  EVENT_LOAD,\n  EVENT_TRANSITION_END,\n  EVENT_VIEWED,\n} from './constants';\nimport {\n  addClass,\n  addListener,\n  assign,\n  forEach,\n  getImageNameFromURL,\n  getImageNaturalSizes,\n  getTransforms,\n  isFunction,\n  isString,\n  removeClass,\n  removeListener,\n  setData,\n  setStyle,\n} from './utilities';\n\nexport default {\n  render() {\n    this.initContainer();\n    this.initViewer();\n    this.initList();\n    this.renderViewer();\n  },\n\n  initContainer() {\n    this.containerData = {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n  },\n\n  initViewer() {\n    const { options, parent } = this;\n    let viewerData;\n\n    if (options.inline) {\n      viewerData = {\n        width: Math.max(parent.offsetWidth, options.minWidth),\n        height: Math.max(parent.offsetHeight, options.minHeight),\n      };\n\n      this.parentData = viewerData;\n    }\n\n    if (this.fulled || !viewerData) {\n      viewerData = this.containerData;\n    }\n\n    this.viewerData = assign({}, viewerData);\n  },\n\n  renderViewer() {\n    if (this.options.inline && !this.fulled) {\n      setStyle(this.viewer, this.viewerData);\n    }\n  },\n\n  initList() {\n    const { element, options, list } = this;\n    const items = [];\n\n    forEach(this.images, (image, i) => {\n      const { src } = image;\n      const alt = image.alt || getImageNameFromURL(src);\n      let { url } = options;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      }\n\n      if (src || url) {\n        items.push('<li>' +\n          '<img' +\n            ` src=\"${src || url}\"` +\n            ' role=\"button\"' +\n            ' data-viewer-action=\"view\"' +\n            ` data-index=\"${i}\"` +\n            ` data-original-url=\"${url || src}\"` +\n            ` alt=\"${alt}\"` +\n          '>' +\n        '</li>');\n      }\n    });\n\n    list.innerHTML = items.join('');\n    this.items = list.getElementsByTagName('li');\n    forEach(this.items, (item) => {\n      const image = item.firstElementChild;\n\n      setData(image, 'filled', true);\n\n      if (options.loading) {\n        addClass(item, CLASS_LOADING);\n      }\n\n      addListener(image, EVENT_LOAD, (event) => {\n        if (options.loading) {\n          removeClass(item, CLASS_LOADING);\n        }\n\n        this.loadImage(event);\n      }, {\n        once: true,\n      });\n    });\n\n    if (options.transition) {\n      addListener(element, EVENT_VIEWED, () => {\n        addClass(list, CLASS_TRANSITION);\n      }, {\n        once: true,\n      });\n    }\n  },\n\n  renderList(index) {\n    const i = index || this.index;\n    const width = this.items[i].offsetWidth || 30;\n    const outerWidth = width + 1; // 1 pixel of `margin-left` width\n\n    // Place the active item in the center of the screen\n    setStyle(this.list, assign({\n      width: outerWidth * this.length,\n    }, getTransforms({\n      translateX: ((this.viewerData.width - width) / 2) - (outerWidth * i),\n    })));\n  },\n\n  resetList() {\n    const { list } = this;\n\n    list.innerHTML = '';\n    removeClass(list, CLASS_TRANSITION);\n    setStyle(list, getTransforms({\n      translateX: 0,\n    }));\n  },\n\n  initImage(done) {\n    const { options, image, viewerData } = this;\n    const footerHeight = this.footer.offsetHeight;\n    const viewerWidth = viewerData.width;\n    const viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n    const oldImageData = this.imageData || {};\n    let sizingImage;\n\n    this.imageInitializing = {\n      abort() {\n        sizingImage.onload = null;\n      },\n    };\n\n    sizingImage = getImageNaturalSizes(image, (naturalWidth, naturalHeight) => {\n      const aspectRatio = naturalWidth / naturalHeight;\n      let width = viewerWidth;\n      let height = viewerHeight;\n\n      this.imageInitializing = false;\n\n      if (viewerHeight * aspectRatio > viewerWidth) {\n        height = viewerWidth / aspectRatio;\n      } else {\n        width = viewerHeight * aspectRatio;\n      }\n\n      width = Math.min(width * 0.9, naturalWidth);\n      height = Math.min(height * 0.9, naturalHeight);\n\n      const imageData = {\n        naturalWidth,\n        naturalHeight,\n        aspectRatio,\n        ratio: width / naturalWidth,\n        width,\n        height,\n        left: (viewerWidth - width) / 2,\n        top: (viewerHeight - height) / 2,\n      };\n      const initialImageData = assign({}, imageData);\n\n      if (options.rotatable) {\n        imageData.rotate = oldImageData.rotate || 0;\n        initialImageData.rotate = 0;\n      }\n\n      if (options.scalable) {\n        imageData.scaleX = oldImageData.scaleX || 1;\n        imageData.scaleY = oldImageData.scaleY || 1;\n        initialImageData.scaleX = 1;\n        initialImageData.scaleY = 1;\n      }\n\n      this.imageData = imageData;\n      this.initialImageData = initialImageData;\n\n      if (done) {\n        done();\n      }\n    });\n  },\n\n  renderImage(done) {\n    const { image, imageData } = this;\n\n    setStyle(image, assign({\n      width: imageData.width,\n      height: imageData.height,\n      marginLeft: imageData.left,\n      marginTop: imageData.top,\n    }, getTransforms(imageData)));\n\n    if (done) {\n      if ((this.viewing || this.zooming) && this.options.transition) {\n        const onTransitionEnd = () => {\n          this.imageRendering = false;\n          done();\n        };\n\n        this.imageRendering = {\n          abort() {\n            removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n          },\n        };\n\n        addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n          once: true,\n        });\n      } else {\n        done();\n      }\n    }\n  },\n\n  resetImage() {\n    // this.image only defined after viewed\n    if (this.viewing || this.viewed) {\n      const { image } = this;\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      image.parentNode.removeChild(image);\n      this.image = null;\n    }\n  },\n};\n","import {\n  EVENT_CLICK,\n  EVENT_DRAG_START,\n  EVENT_KEY_DOWN,\n  EVENT_POINTER_DOWN,\n  EVENT_POINTER_MOVE,\n  EVENT_POINTER_UP,\n  EVENT_RESIZE,\n  EVENT_WHEEL,\n} from './constants';\nimport {\n  addListener,\n  removeListener,\n} from './utilities';\n\nexport default {\n  bind() {\n    const { element, viewer } = this;\n\n    addListener(viewer, EVENT_CLICK, (this.onClick = this.click.bind(this)));\n    addListener(viewer, EVENT_WHEEL, (this.onWheel = this.wheel.bind(this)));\n    addListener(viewer, EVENT_DRAG_START, (this.onDragStart = this.dragstart.bind(this)));\n    addListener(\n      this.canvas,\n      EVENT_POINTER_DOWN,\n      (this.onPointerDown = this.pointerdown.bind(this)),\n    );\n    addListener(\n      element.ownerDocument,\n      EVENT_POINTER_MOVE,\n      (this.onPointerMove = this.pointermove.bind(this)),\n    );\n    addListener(\n      element.ownerDocument,\n      EVENT_POINTER_UP,\n      (this.onPointerUp = this.pointerup.bind(this)),\n    );\n    addListener(\n      element.ownerDocument,\n      EVENT_KEY_DOWN,\n      (this.onKeyDown = this.keydown.bind(this)),\n    );\n    addListener(window, EVENT_RESIZE, (this.onResize = this.resize.bind(this)));\n  },\n\n  unbind() {\n    const { element, viewer } = this;\n\n    removeListener(viewer, EVENT_CLICK, this.onClick);\n    removeListener(viewer, EVENT_WHEEL, this.onWheel);\n    removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n    removeListener(this.canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n    removeListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onPointerMove);\n    removeListener(element.ownerDocument, EVENT_POINTER_UP, this.onPointerUp);\n    removeListener(element.ownerDocument, EVENT_KEY_DOWN, this.onKeyDown);\n    removeListener(window, EVENT_RESIZE, this.onResize);\n  },\n};\n","import {\n  ACTION_MOVE,\n  ACTION_SWITCH,\n  ACTION_ZOOM,\n  CLASS_INVISIBLE,\n  CLASS_LOADING,\n  CLASS_MOVE,\n  CLASS_TRANSITION,\n  DATA_ACTION,\n  EVENT_LOAD,\n  EVENT_VIEWED,\n} from './constants';\nimport {\n  addClass,\n  addListener,\n  assign,\n  dispatchEvent,\n  forEach,\n  getData,\n  getImageNaturalSizes,\n  getPointer,\n  getTransforms,\n  isFunction,\n  removeClass,\n  setStyle,\n  toggleClass,\n} from './utilities';\n\nexport default {\n  click({ target }) {\n    const { options, imageData } = this;\n    const action = getData(target, DATA_ACTION);\n\n    switch (action) {\n      case 'mix':\n        if (this.played) {\n          this.stop();\n        } else if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          } else {\n            this.full();\n          }\n        } else {\n          this.hide();\n        }\n\n        break;\n\n      case 'hide':\n        this.hide();\n        break;\n\n      case 'view':\n        this.view(getData(target, 'index'));\n        break;\n\n      case 'zoom-in':\n        this.zoom(0.1, true);\n        break;\n\n      case 'zoom-out':\n        this.zoom(-0.1, true);\n        break;\n\n      case 'one-to-one':\n        this.toggle();\n        break;\n\n      case 'reset':\n        this.reset();\n        break;\n\n      case 'prev':\n        this.prev(options.loop);\n        break;\n\n      case 'play':\n        this.play(options.fullscreen);\n        break;\n\n      case 'next':\n        this.next(options.loop);\n        break;\n\n      case 'rotate-left':\n        this.rotate(-90);\n        break;\n\n      case 'rotate-right':\n        this.rotate(90);\n        break;\n\n      case 'flip-horizontal':\n        this.scaleX(-imageData.scaleX || -1);\n        break;\n\n      case 'flip-vertical':\n        this.scaleY(-imageData.scaleY || -1);\n        break;\n\n      default:\n        if (this.played) {\n          this.stop();\n        }\n    }\n  },\n\n  load() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n      this.timeout = false;\n    }\n\n    const {\n      element,\n      options,\n      image,\n      index,\n      viewerData,\n    } = this;\n\n    removeClass(image, CLASS_INVISIBLE);\n\n    if (options.loading) {\n      removeClass(this.canvas, CLASS_LOADING);\n    }\n\n    image.style.cssText = (\n      'height:0;' +\n      `margin-left:${viewerData.width / 2}px;` +\n      `margin-top:${viewerData.height / 2}px;` +\n      'max-width:none!important;' +\n      'position:absolute;' +\n      'width:0;'\n    );\n\n    this.initImage(() => {\n      toggleClass(image, CLASS_MOVE, options.movable);\n      toggleClass(image, CLASS_TRANSITION, options.transition);\n\n      this.renderImage(() => {\n        this.viewed = true;\n        this.viewing = false;\n\n        if (isFunction(options.viewed)) {\n          addListener(element, EVENT_VIEWED, options.viewed, {\n            once: true,\n          });\n        }\n\n        dispatchEvent(element, EVENT_VIEWED, {\n          originalImage: this.images[index],\n          index,\n          image,\n        });\n      });\n    });\n  },\n\n  loadImage(e) {\n    const image = e.target;\n    const parent = image.parentNode;\n    const parentWidth = parent.offsetWidth || 30;\n    const parentHeight = parent.offsetHeight || 50;\n    const filled = !!getData(image, 'filled');\n\n    getImageNaturalSizes(image, (naturalWidth, naturalHeight) => {\n      const aspectRatio = naturalWidth / naturalHeight;\n      let width = parentWidth;\n      let height = parentHeight;\n\n      if (parentHeight * aspectRatio > parentWidth) {\n        if (filled) {\n          width = parentHeight * aspectRatio;\n        } else {\n          height = parentWidth / aspectRatio;\n        }\n      } else if (filled) {\n        height = parentWidth / aspectRatio;\n      } else {\n        width = parentHeight * aspectRatio;\n      }\n\n      setStyle(image, assign({\n        width,\n        height,\n      }, getTransforms({\n        translateX: (parentWidth - width) / 2,\n        translateY: (parentHeight - height) / 2,\n      })));\n    });\n  },\n\n  keydown(e) {\n    const { options } = this;\n\n    if (!this.fulled || !options.keyboard) {\n      return;\n    }\n\n    switch (e.keyCode || e.which || e.charCode) {\n      // Escape\n      case 27:\n        if (this.played) {\n          this.stop();\n        } else if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n        } else {\n          this.hide();\n        }\n\n        break;\n\n      // Space\n      case 32:\n        if (this.played) {\n          this.stop();\n        }\n\n        break;\n\n      // ArrowLeft\n      case 37:\n        this.prev(options.loop);\n        break;\n\n      // ArrowUp\n      case 38:\n        // Prevent scroll on Firefox\n        e.preventDefault();\n\n        // Zoom in\n        this.zoom(options.zoomRatio, true);\n        break;\n\n      // ArrowRight\n      case 39:\n        this.next(options.loop);\n        break;\n\n      // ArrowDown\n      case 40:\n        // Prevent scroll on Firefox\n        e.preventDefault();\n\n        // Zoom out\n        this.zoom(-options.zoomRatio, true);\n        break;\n\n      // Ctrl + 0\n      case 48:\n        // Fall through\n\n      // Ctrl + 1\n      // eslint-disable-next-line no-fallthrough\n      case 49:\n        if (e.ctrlKey) {\n          e.preventDefault();\n          this.toggle();\n        }\n\n        break;\n\n      default:\n    }\n  },\n\n  dragstart(e) {\n    if (e.target.tagName.toLowerCase() === 'img') {\n      e.preventDefault();\n    }\n  },\n\n  pointerdown(e) {\n    const { options, pointers } = this;\n\n    if (!this.viewed || this.showing || this.viewing || this.hiding) {\n      return;\n    }\n\n    // This line is required for preventing page zooming in iOS browsers\n    e.preventDefault();\n\n    if (e.changedTouches) {\n      forEach(e.changedTouches, (touch) => {\n        pointers[touch.identifier] = getPointer(touch);\n      });\n    } else {\n      pointers[e.pointerId || 0] = getPointer(e);\n    }\n\n    let action = options.movable ? ACTION_MOVE : false;\n\n    if (Object.keys(pointers).length > 1) {\n      action = ACTION_ZOOM;\n    } else if ((e.pointerType === 'touch' || e.type === 'touchstart') && this.isSwitchable()) {\n      action = ACTION_SWITCH;\n    }\n\n    if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n      removeClass(this.image, CLASS_TRANSITION);\n    }\n\n    this.action = action;\n  },\n\n  pointermove(e) {\n    const {\n      pointers,\n      action,\n    } = this;\n\n    if (!this.viewed || !action) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (e.changedTouches) {\n      forEach(e.changedTouches, (touch) => {\n        assign(pointers[touch.identifier], getPointer(touch, true));\n      });\n    } else {\n      assign(pointers[e.pointerId || 0], getPointer(e, true));\n    }\n\n    this.change(e);\n  },\n\n  pointerup(e) {\n    const { action, pointers } = this;\n\n    if (e.changedTouches) {\n      forEach(e.changedTouches, (touch) => {\n        delete pointers[touch.identifier];\n      });\n    } else {\n      delete pointers[e.pointerId || 0];\n    }\n\n    if (!action) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (this.options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n      addClass(this.image, CLASS_TRANSITION);\n    }\n\n    this.action = false;\n  },\n\n  resize() {\n    if (!this.isShown || this.hiding) {\n      return;\n    }\n\n    this.initContainer();\n    this.initViewer();\n    this.renderViewer();\n    this.renderList();\n\n    if (this.viewed) {\n      this.initImage(() => {\n        this.renderImage();\n      });\n    }\n\n    if (this.played) {\n      if (this.options.fullscreen && this.fulled &&\n        !document.fullscreenElement &&\n        !document.mozFullScreenElement &&\n        !document.webkitFullscreenElement &&\n        !document.msFullscreenElement) {\n        this.stop();\n        return;\n      }\n\n      forEach(this.player.getElementsByTagName('img'), (image) => {\n        addListener(image, EVENT_LOAD, this.loadImage.bind(this), {\n          once: true,\n        });\n        dispatchEvent(image, EVENT_LOAD);\n      });\n    }\n  },\n\n  wheel(e) {\n    if (!this.viewed) {\n      return;\n    }\n\n    e.preventDefault();\n\n    // Limit wheel speed to prevent zoom too fast\n    if (this.wheeling) {\n      return;\n    }\n\n    this.wheeling = true;\n\n    setTimeout(() => {\n      this.wheeling = false;\n    }, 50);\n\n    const ratio = Number(this.options.zoomRatio) || 0.1;\n    let delta = 1;\n\n    if (e.deltaY) {\n      delta = e.deltaY > 0 ? 1 : -1;\n    } else if (e.wheelDelta) {\n      delta = -e.wheelDelta / 120;\n    } else if (e.detail) {\n      delta = e.detail > 0 ? 1 : -1;\n    }\n\n    this.zoom(-delta * ratio, true, e);\n  },\n};\n","import {\n  CLASS_ACTIVE,\n  CLASS_FADE,\n  CLASS_FIXED,\n  CLASS_FULLSCREEN_EXIT,\n  CLASS_HIDE,\n  CLASS_IN,\n  CLASS_INVISIBLE,\n  CLASS_LOADING,\n  CLASS_SHOW,\n  CLASS_TRANSITION,\n  EVENT_CLICK,\n  EVENT_HIDE,\n  EVENT_LOAD,\n  EVENT_SHOW,\n  EVENT_TRANSITION_END,\n  EVENT_VIEW,\n  EVENT_VIEWED,\n  EVENT_ZOOM,\n  EVENT_ZOOMED,\n  NAMESPACE,\n} from './constants';\nimport {\n  addClass,\n  addListener,\n  assign,\n  dispatchEvent,\n  forEach,\n  getData,\n  getOffset,\n  getPointersCenter,\n  hasClass,\n  isFunction,\n  isNumber,\n  isUndefined,\n  removeClass,\n  removeData,\n  removeListener,\n  setStyle,\n  toggleClass,\n} from './utilities';\n\nexport default {\n  /** Show the viewer (only available in modal mode)\n   * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n   * @returns {Viewer} this\n   */\n  show(immediate = false) {\n    const { element, options } = this;\n\n    if (options.inline || this.showing || this.isShown || this.showing) {\n      return this;\n    }\n\n    if (!this.ready) {\n      this.build();\n\n      if (this.ready) {\n        this.show(immediate);\n      }\n\n      return this;\n    }\n\n    if (isFunction(options.show)) {\n      addListener(element, EVENT_SHOW, options.show, {\n        once: true,\n      });\n    }\n\n    if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n      return this;\n    }\n\n    if (this.hiding) {\n      this.transitioning.abort();\n    }\n\n    this.showing = true;\n    this.open();\n\n    const { viewer } = this;\n\n    removeClass(viewer, CLASS_HIDE);\n\n    if (options.transition && !immediate) {\n      const shown = this.shown.bind(this);\n\n      this.transitioning = {\n        abort() {\n          removeListener(viewer, EVENT_TRANSITION_END, shown);\n          removeClass(viewer, CLASS_IN);\n        },\n      };\n\n      addClass(viewer, CLASS_TRANSITION);\n\n      // Force reflow to enable CSS3 transition\n      // eslint-disable-next-line\n      viewer.offsetWidth;\n      addListener(viewer, EVENT_TRANSITION_END, shown, {\n        once: true,\n      });\n      addClass(viewer, CLASS_IN);\n    } else {\n      addClass(viewer, CLASS_IN);\n      this.shown();\n    }\n\n    return this;\n  },\n\n  /**\n   * Hide the viewer (only available in modal mode)\n   * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n   * @returns {Viewer} this\n   */\n  hide(immediate = false) {\n    const { element, options } = this;\n\n    if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n      return this;\n    }\n\n    if (isFunction(options.hide)) {\n      addListener(element, EVENT_HIDE, options.hide, {\n        once: true,\n      });\n    }\n\n    if (dispatchEvent(element, EVENT_HIDE) === false) {\n      return this;\n    }\n\n    if (this.showing) {\n      this.transitioning.abort();\n    }\n\n    this.hiding = true;\n\n    if (this.played) {\n      this.stop();\n    } else if (this.viewing) {\n      this.viewing.abort();\n    }\n\n    const { viewer } = this;\n\n    if (options.transition && !immediate) {\n      const hidden = this.hidden.bind(this);\n      const hide = () => {\n        addListener(viewer, EVENT_TRANSITION_END, hidden, {\n          once: true,\n        });\n        removeClass(viewer, CLASS_IN);\n      };\n\n      this.transitioning = {\n        abort() {\n          if (this.viewed) {\n            removeListener(this.image, EVENT_TRANSITION_END, hide);\n          } else {\n            removeListener(viewer, EVENT_TRANSITION_END, hidden);\n          }\n        },\n      };\n\n      if (this.viewed) {\n        addListener(this.image, EVENT_TRANSITION_END, hide, {\n          once: true,\n        });\n        this.zoomTo(0, false, false, true);\n      } else {\n        hide();\n      }\n    } else {\n      removeClass(viewer, CLASS_IN);\n      this.hidden();\n    }\n\n    return this;\n  },\n\n  /**\n   * View one of the images with image's index\n   * @param {number} index - The index of the image to view.\n   * @returns {Viewer} this\n   */\n  view(index = 0) {\n    index = Number(index) || 0;\n\n    if (!this.isShown) {\n      this.index = index;\n      return this.show();\n    }\n\n    if (this.hiding || this.played || index < 0 || index >= this.length ||\n      (this.viewed && index === this.index)) {\n      return this;\n    }\n\n    if (this.viewing) {\n      this.viewing.abort();\n    }\n\n    const {\n      element,\n      options,\n      title,\n      canvas,\n    } = this;\n    const item = this.items[index];\n    const img = item.querySelector('img');\n    const url = getData(img, 'originalUrl');\n    const alt = img.getAttribute('alt');\n    const image = document.createElement('img');\n\n    image.src = url;\n    image.alt = alt;\n\n    if (isFunction(options.view)) {\n      addListener(element, EVENT_VIEW, options.view, {\n        once: true,\n      });\n    }\n\n    if (dispatchEvent(element, EVENT_VIEW, {\n      originalImage: this.images[index],\n      index,\n      image,\n    }) === false || !this.isShown || this.hiding || this.played) {\n      return this;\n    }\n\n    this.image = image;\n    removeClass(this.items[this.index], CLASS_ACTIVE);\n    addClass(item, CLASS_ACTIVE);\n    this.viewed = false;\n    this.index = index;\n    this.imageData = {};\n    addClass(image, CLASS_INVISIBLE);\n\n    if (options.loading) {\n      addClass(canvas, CLASS_LOADING);\n    }\n\n    canvas.innerHTML = '';\n    canvas.appendChild(image);\n\n    // Center current item\n    this.renderList();\n\n    // Clear title\n    title.innerHTML = '';\n\n    // Generate title after viewed\n    const onViewed = () => {\n      const { imageData } = this;\n\n      title.textContent = `${alt} (${imageData.naturalWidth} × ${imageData.naturalHeight})`;\n    };\n    let onLoad;\n\n    addListener(element, EVENT_VIEWED, onViewed, {\n      once: true,\n    });\n\n    this.viewing = {\n      abort() {\n        removeListener(element, EVENT_VIEWED, onViewed);\n\n        if (image.complete) {\n          if (this.imageRendering) {\n            this.imageRendering.abort();\n          } else if (this.imageInitializing) {\n            this.imageInitializing.abort();\n          }\n        } else {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (this.timeout) {\n            clearTimeout(this.timeout);\n          }\n        }\n      },\n    };\n\n    if (image.complete) {\n      this.load();\n    } else {\n      addListener(image, EVENT_LOAD, onLoad = this.load.bind(this), {\n        once: true,\n      });\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n\n      // Make the image visible if it fails to load within 1s\n      this.timeout = setTimeout(() => {\n        removeClass(image, CLASS_INVISIBLE);\n        this.timeout = false;\n      }, 1000);\n    }\n\n    return this;\n  },\n\n  /**\n   * View the previous image\n   * @param {boolean} [loop=false] - Indicate if view the last one\n   * when it is the first one at present.\n   * @returns {Viewer} this\n   */\n  prev(loop = false) {\n    let index = this.index - 1;\n\n    if (index < 0) {\n      index = loop ? this.length - 1 : 0;\n    }\n\n    this.view(index);\n    return this;\n  },\n\n  /**\n   * View the next image\n   * @param {boolean} [loop=false] - Indicate if view the first one\n   * when it is the last one at present.\n   * @returns {Viewer} this\n   */\n  next(loop = false) {\n    const maxIndex = this.length - 1;\n    let index = this.index + 1;\n\n    if (index > maxIndex) {\n      index = loop ? 0 : maxIndex;\n    }\n\n    this.view(index);\n    return this;\n  },\n\n  /**\n   * Move the image with relative offsets.\n   * @param {number} offsetX - The relative offset distance on the x-axis.\n   * @param {number} offsetY - The relative offset distance on the y-axis.\n   * @returns {Viewer} this\n   */\n  move(offsetX, offsetY) {\n    const { imageData } = this;\n\n    this.moveTo(\n      isUndefined(offsetX) ? offsetX : imageData.left + Number(offsetX),\n      isUndefined(offsetY) ? offsetY : imageData.top + Number(offsetY),\n    );\n\n    return this;\n  },\n\n  /**\n   * Move the image to an absolute point.\n   * @param {number} x - The x-axis coordinate.\n   * @param {number} [y=x] - The y-axis coordinate.\n   * @returns {Viewer} this\n   */\n  moveTo(x, y = x) {\n    const { imageData } = this;\n\n    x = Number(x);\n    y = Number(y);\n\n    if (this.viewed && !this.played && this.options.movable) {\n      let changed = false;\n\n      if (isNumber(x)) {\n        imageData.left = x;\n        changed = true;\n      }\n\n      if (isNumber(y)) {\n        imageData.top = y;\n        changed = true;\n      }\n\n      if (changed) {\n        this.renderImage();\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * Zoom the image with a relative ratio.\n   * @param {number} ratio - The target ratio.\n   * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n   * @param {Event} [_originalEvent=null] - The original event if any.\n   * @returns {Viewer} this\n   */\n  zoom(ratio, hasTooltip = false, _originalEvent = null) {\n    const { imageData } = this;\n\n    ratio = Number(ratio);\n\n    if (ratio < 0) {\n      ratio = 1 / (1 - ratio);\n    } else {\n      ratio = 1 + ratio;\n    }\n\n    this.zoomTo((imageData.width * ratio) / imageData.naturalWidth, hasTooltip, _originalEvent);\n\n    return this;\n  },\n\n  /**\n   * Zoom the image to an absolute ratio.\n   * @param {number} ratio - The target ratio.\n   * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n   * @param {Event} [_originalEvent=null] - The original event if any.\n   * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n   * @returns {Viewer} this\n   */\n  zoomTo(ratio, hasTooltip = false, _originalEvent = null, _zoomable = false) {\n    const {\n      element,\n      options,\n      pointers,\n      imageData,\n    } = this;\n\n    ratio = Math.max(0, ratio);\n\n    if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n      if (!_zoomable) {\n        const minZoomRatio = Math.max(0.01, options.minZoomRatio);\n        const maxZoomRatio = Math.min(100, options.maxZoomRatio);\n\n        ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n      }\n\n      if (_originalEvent && ratio > 0.95 && ratio < 1.05) {\n        ratio = 1;\n      }\n\n      const newWidth = imageData.naturalWidth * ratio;\n      const newHeight = imageData.naturalHeight * ratio;\n      const oldRatio = imageData.width / imageData.naturalWidth;\n\n      if (isFunction(options.zoom)) {\n        addListener(element, EVENT_ZOOM, options.zoom, {\n          once: true,\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_ZOOM, {\n        ratio,\n        oldRatio,\n        originalEvent: _originalEvent,\n      }) === false) {\n        return this;\n      }\n\n      this.zooming = true;\n\n      if (_originalEvent) {\n        const offset = getOffset(this.viewer);\n        const center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n          pageX: _originalEvent.pageX,\n          pageY: _originalEvent.pageY,\n        };\n\n        // Zoom from the triggering point of the event\n        imageData.left -= (newWidth - imageData.width) * (\n          ((center.pageX - offset.left) - imageData.left) / imageData.width\n        );\n        imageData.top -= (newHeight - imageData.height) * (\n          ((center.pageY - offset.top) - imageData.top) / imageData.height\n        );\n      } else {\n        // Zoom from the center of the image\n        imageData.left -= (newWidth - imageData.width) / 2;\n        imageData.top -= (newHeight - imageData.height) / 2;\n      }\n\n      imageData.width = newWidth;\n      imageData.height = newHeight;\n      imageData.ratio = ratio;\n      this.renderImage(() => {\n        this.zooming = false;\n\n        if (isFunction(options.zoomed)) {\n          addListener(element, EVENT_ZOOMED, options.zoomed, {\n            once: true,\n          });\n        }\n\n        dispatchEvent(element, EVENT_ZOOMED, {\n          ratio,\n          oldRatio,\n          originalEvent: _originalEvent,\n        });\n      });\n\n      if (hasTooltip) {\n        this.tooltip();\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * Rotate the image with a relative degree.\n   * @param {number} degree - The rotate degree.\n   * @returns {Viewer} this\n   */\n  rotate(degree) {\n    this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n\n    return this;\n  },\n\n  /**\n   * Rotate the image to an absolute degree.\n   * @param {number} degree - The rotate degree.\n   * @returns {Viewer} this\n   */\n  rotateTo(degree) {\n    const { imageData } = this;\n\n    degree = Number(degree);\n\n    if (isNumber(degree) && this.viewed && !this.played && this.options.rotatable) {\n      imageData.rotate = degree;\n      this.renderImage();\n    }\n\n    return this;\n  },\n\n  /**\n   * Scale the image on the x-axis.\n   * @param {number} scaleX - The scale ratio on the x-axis.\n   * @returns {Viewer} this\n   */\n  scaleX(scaleX) {\n    this.scale(scaleX, this.imageData.scaleY);\n\n    return this;\n  },\n\n  /**\n   * Scale the image on the y-axis.\n   * @param {number} scaleY - The scale ratio on the y-axis.\n   * @returns {Viewer} this\n   */\n  scaleY(scaleY) {\n    this.scale(this.imageData.scaleX, scaleY);\n\n    return this;\n  },\n\n  /**\n   * Scale the image.\n   * @param {number} scaleX - The scale ratio on the x-axis.\n   * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n   * @returns {Viewer} this\n   */\n  scale(scaleX, scaleY = scaleX) {\n    const { imageData } = this;\n\n    scaleX = Number(scaleX);\n    scaleY = Number(scaleY);\n\n    if (this.viewed && !this.played && this.options.scalable) {\n      let changed = false;\n\n      if (isNumber(scaleX)) {\n        imageData.scaleX = scaleX;\n        changed = true;\n      }\n\n      if (isNumber(scaleY)) {\n        imageData.scaleY = scaleY;\n        changed = true;\n      }\n\n      if (changed) {\n        this.renderImage();\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * Play the images\n   * @param {boolean} [fullscreen=false] - Indicate if request fullscreen or not.\n   * @returns {Viewer} this\n   */\n  play(fullscreen = false) {\n    if (!this.isShown || this.played) {\n      return this;\n    }\n\n    const { options, player } = this;\n    const onLoad = this.loadImage.bind(this);\n    const list = [];\n    let total = 0;\n    let index = 0;\n\n    this.played = true;\n    this.onLoadWhenPlay = onLoad;\n\n    if (fullscreen) {\n      this.requestFullscreen();\n    }\n\n    addClass(player, CLASS_SHOW);\n    forEach(this.items, (item, i) => {\n      const img = item.querySelector('img');\n      const image = document.createElement('img');\n\n      image.src = getData(img, 'originalUrl');\n      image.alt = img.getAttribute('alt');\n      total += 1;\n      addClass(image, CLASS_FADE);\n      toggleClass(image, CLASS_TRANSITION, options.transition);\n\n      if (hasClass(item, CLASS_ACTIVE)) {\n        addClass(image, CLASS_IN);\n        index = i;\n      }\n\n      list.push(image);\n      addListener(image, EVENT_LOAD, onLoad, {\n        once: true,\n      });\n      player.appendChild(image);\n    });\n\n    if (isNumber(options.interval) && options.interval > 0) {\n      const play = () => {\n        this.playing = setTimeout(() => {\n          removeClass(list[index], CLASS_IN);\n          index += 1;\n          index = index < total ? index : 0;\n          addClass(list[index], CLASS_IN);\n          play();\n        }, options.interval);\n      };\n\n      if (total > 1) {\n        play();\n      }\n    }\n\n    return this;\n  },\n\n  // Stop play\n  stop() {\n    if (!this.played) {\n      return this;\n    }\n\n    const { player } = this;\n\n    this.played = false;\n    clearTimeout(this.playing);\n    forEach(player.getElementsByTagName('img'), (image) => {\n      removeListener(image, EVENT_LOAD, this.onLoadWhenPlay);\n    });\n    removeClass(player, CLASS_SHOW);\n    player.innerHTML = '';\n    this.exitFullscreen();\n\n    return this;\n  },\n\n  // Enter modal mode (only available in inline mode)\n  full() {\n    const {\n      options,\n      viewer,\n      image,\n      list,\n    } = this;\n\n    if (!this.isShown || this.played || this.fulled || !options.inline) {\n      return this;\n    }\n\n    this.fulled = true;\n    this.open();\n    addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n    if (options.transition) {\n      removeClass(list, CLASS_TRANSITION);\n\n      if (this.viewed) {\n        removeClass(image, CLASS_TRANSITION);\n      }\n    }\n\n    addClass(viewer, CLASS_FIXED);\n    viewer.setAttribute('style', '');\n    setStyle(viewer, {\n      zIndex: options.zIndex,\n    });\n\n    this.initContainer();\n    this.viewerData = assign({}, this.containerData);\n    this.renderList();\n\n    if (this.viewed) {\n      this.initImage(() => {\n        this.renderImage(() => {\n          if (options.transition) {\n            setTimeout(() => {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n    }\n\n    return this;\n  },\n\n  // Exit modal mode (only available in inline mode)\n  exit() {\n    const {\n      options,\n      viewer,\n      image,\n      list,\n    } = this;\n\n    if (!this.isShown || this.played || !this.fulled || !options.inline) {\n      return this;\n    }\n\n    this.fulled = false;\n    this.close();\n    removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n    if (options.transition) {\n      removeClass(list, CLASS_TRANSITION);\n\n      if (this.viewed) {\n        removeClass(image, CLASS_TRANSITION);\n      }\n    }\n\n    removeClass(viewer, CLASS_FIXED);\n    setStyle(viewer, {\n      zIndex: options.zIndexInline,\n    });\n\n    this.viewerData = assign({}, this.parentData);\n    this.renderViewer();\n    this.renderList();\n\n    if (this.viewed) {\n      this.initImage(() => {\n        this.renderImage(() => {\n          if (options.transition) {\n            setTimeout(() => {\n              addClass(image, CLASS_TRANSITION);\n              addClass(list, CLASS_TRANSITION);\n            }, 0);\n          }\n        });\n      });\n    }\n\n    return this;\n  },\n\n  // Show the current ratio of the image with percentage\n  tooltip() {\n    const { options, tooltipBox, imageData } = this;\n\n    if (!this.viewed || this.played || !options.tooltip) {\n      return this;\n    }\n\n    tooltipBox.textContent = `${Math.round(imageData.ratio * 100)}%`;\n\n    if (!this.tooltipping) {\n      if (options.transition) {\n        if (this.fading) {\n          dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n        }\n\n        addClass(tooltipBox, CLASS_SHOW);\n        addClass(tooltipBox, CLASS_FADE);\n        addClass(tooltipBox, CLASS_TRANSITION);\n\n        // Force reflow to enable CSS3 transition\n        // eslint-disable-next-line\n        tooltipBox.offsetWidth;\n        addClass(tooltipBox, CLASS_IN);\n      } else {\n        addClass(tooltipBox, CLASS_SHOW);\n      }\n    } else {\n      clearTimeout(this.tooltipping);\n    }\n\n    this.tooltipping = setTimeout(() => {\n      if (options.transition) {\n        addListener(tooltipBox, EVENT_TRANSITION_END, () => {\n          removeClass(tooltipBox, CLASS_SHOW);\n          removeClass(tooltipBox, CLASS_FADE);\n          removeClass(tooltipBox, CLASS_TRANSITION);\n          this.fading = false;\n        }, {\n          once: true,\n        });\n\n        removeClass(tooltipBox, CLASS_IN);\n        this.fading = true;\n      } else {\n        removeClass(tooltipBox, CLASS_SHOW);\n      }\n\n      this.tooltipping = false;\n    }, 1000);\n\n    return this;\n  },\n\n  // Toggle the image size between its natural size and initial size\n  toggle() {\n    if (this.imageData.ratio === 1) {\n      this.zoomTo(this.initialImageData.ratio, true);\n    } else {\n      this.zoomTo(1, true);\n    }\n\n    return this;\n  },\n\n  // Reset the image to its initial state\n  reset() {\n    if (this.viewed && !this.played) {\n      this.imageData = assign({}, this.initialImageData);\n      this.renderImage();\n    }\n\n    return this;\n  },\n\n  // Update viewer when images changed\n  update() {\n    const { element, options, isImg } = this;\n\n    // Destroy viewer if the target image was deleted\n    if (isImg && !element.parentNode) {\n      return this.destroy();\n    }\n\n    const images = [];\n\n    forEach(isImg ? [element] : element.querySelectorAll('img'), (image) => {\n      if (options.filter) {\n        if (options.filter(image)) {\n          images.push(image);\n        }\n      } else {\n        images.push(image);\n      }\n    });\n\n    if (!images.length) {\n      return this;\n    }\n\n    this.images = images;\n    this.length = images.length;\n\n    if (this.ready) {\n      const indexes = [];\n\n      forEach(this.items, (item, i) => {\n        const img = item.querySelector('img');\n        const image = images[i];\n\n        if (image) {\n          if (image.src !== img.src) {\n            indexes.push(i);\n          }\n        } else {\n          indexes.push(i);\n        }\n      });\n\n      setStyle(this.list, {\n        width: 'auto',\n      });\n\n      this.initList();\n\n      if (this.isShown) {\n        if (this.length) {\n          if (this.viewed) {\n            const index = indexes.indexOf(this.index);\n\n            if (index >= 0) {\n              this.viewed = false;\n              this.view(Math.max(this.index - (index + 1), 0));\n            } else {\n              addClass(this.items[this.index], CLASS_ACTIVE);\n            }\n          }\n        } else {\n          this.image = null;\n          this.viewed = false;\n          this.index = 0;\n          this.imageData = {};\n          this.canvas.innerHTML = '';\n          this.title.innerHTML = '';\n        }\n      }\n    } else {\n      this.build();\n    }\n\n    return this;\n  },\n\n  // Destroy the viewer\n  destroy() {\n    const { element, options } = this;\n\n    if (!getData(element, NAMESPACE)) {\n      return this;\n    }\n\n    this.destroyed = true;\n\n    if (this.ready) {\n      if (this.played) {\n        this.stop();\n      }\n\n      if (options.inline) {\n        if (this.fulled) {\n          this.exit();\n        }\n\n        this.unbind();\n      } else if (this.isShown) {\n        if (this.viewing) {\n          if (this.imageRendering) {\n            this.imageRendering.abort();\n          } else if (this.imageInitializing) {\n            this.imageInitializing.abort();\n          }\n        }\n\n        if (this.hiding) {\n          this.transitioning.abort();\n        }\n\n        this.hidden();\n      } else if (this.showing) {\n        this.transitioning.abort();\n        this.hidden();\n      }\n\n      this.ready = false;\n      this.viewer.parentNode.removeChild(this.viewer);\n    } else if (options.inline) {\n      if (this.delaying) {\n        this.delaying.abort();\n      } else if (this.initializing) {\n        this.initializing.abort();\n      }\n    }\n\n    if (!options.inline) {\n      removeListener(element, EVENT_CLICK, this.onStart);\n    }\n\n    removeData(element, NAMESPACE);\n    return this;\n  },\n};\n","import {\n  ACTION_MOVE,\n  ACTION_SWITCH,\n  ACTION_ZOOM,\n  CLASS_HIDE,\n  CLASS_OPEN,\n  EVENT_HIDDEN,\n  EVENT_SHOWN,\n} from './constants';\nimport {\n  addClass,\n  addListener,\n  dispatchEvent,\n  forEach,\n  getMaxZoomRatio,\n  isFunction,\n  removeClass,\n} from './utilities';\n\nexport default {\n  open() {\n    const { body } = this;\n\n    addClass(body, CLASS_OPEN);\n\n    body.style.paddingRight = `${this.scrollbarWidth + (parseFloat(this.initialBodyPaddingRight) || 0)}px`;\n  },\n\n  close() {\n    const { body } = this;\n\n    removeClass(body, CLASS_OPEN);\n    body.style.paddingRight = this.initialBodyPaddingRight;\n  },\n\n  shown() {\n    const { element, options } = this;\n\n    this.fulled = true;\n    this.isShown = true;\n    this.render();\n    this.bind();\n    this.showing = false;\n\n    if (isFunction(options.shown)) {\n      addListener(element, EVENT_SHOWN, options.shown, {\n        once: true,\n      });\n    }\n\n    if (dispatchEvent(element, EVENT_SHOWN) === false) {\n      return;\n    }\n\n    if (this.ready && this.isShown && !this.hiding) {\n      this.view(this.index);\n    }\n  },\n\n  hidden() {\n    const { element, options } = this;\n\n    this.fulled = false;\n    this.viewed = false;\n    this.isShown = false;\n    this.close();\n    this.unbind();\n    addClass(this.viewer, CLASS_HIDE);\n    this.resetList();\n    this.resetImage();\n    this.hiding = false;\n\n    if (!this.destroyed) {\n      if (isFunction(options.hidden)) {\n        addListener(element, EVENT_HIDDEN, options.hidden, {\n          once: true,\n        });\n      }\n\n      dispatchEvent(element, EVENT_HIDDEN);\n    }\n  },\n\n  requestFullscreen() {\n    const document = this.element.ownerDocument;\n\n    if (this.fulled && !document.fullscreenElement && !document.mozFullScreenElement &&\n      !document.webkitFullscreenElement && !document.msFullscreenElement) {\n      const { documentElement } = document;\n\n      if (documentElement.requestFullscreen) {\n        documentElement.requestFullscreen();\n      } else if (documentElement.msRequestFullscreen) {\n        documentElement.msRequestFullscreen();\n      } else if (documentElement.mozRequestFullScreen) {\n        documentElement.mozRequestFullScreen();\n      } else if (documentElement.webkitRequestFullscreen) {\n        documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n      }\n    }\n  },\n\n  exitFullscreen() {\n    if (this.fulled) {\n      const document = this.element.ownerDocument;\n\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      }\n    }\n  },\n\n  change(e) {\n    const { options, pointers } = this;\n    const pointer = pointers[Object.keys(pointers)[0]];\n    const offsetX = pointer.endX - pointer.startX;\n    const offsetY = pointer.endY - pointer.startY;\n\n    switch (this.action) {\n      // Move the current image\n      case ACTION_MOVE:\n        this.move(offsetX, offsetY);\n        break;\n\n      // Zoom the current image\n      case ACTION_ZOOM:\n        this.zoom(getMaxZoomRatio(pointers), false, e);\n        break;\n\n      case ACTION_SWITCH: {\n        this.action = 'switched';\n\n        const absoluteOffsetX = Math.abs(offsetX);\n\n        if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n          // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n          this.pointers = {};\n\n          if (offsetX > 1) {\n            this.prev(options.loop);\n          } else if (offsetX < -1) {\n            this.next(options.loop);\n          }\n        }\n\n        break;\n      }\n\n      default:\n    }\n\n    // Override\n    forEach(pointers, (p) => {\n      p.startX = p.endX;\n      p.startY = p.endY;\n    });\n  },\n\n  isSwitchable() {\n    const { imageData, viewerData } = this;\n\n    return this.length > 1 && imageData.left >= 0 && imageData.top >= 0 &&\n      imageData.width <= viewerData.width &&\n      imageData.height <= viewerData.height;\n  },\n};\n","import DEFAULTS from './defaults';\nimport TEMPLATE from './template';\nimport render from './render';\nimport events from './events';\nimport handlers from './handlers';\nimport methods from './methods';\nimport others from './others';\nimport {\n  BUTTONS,\n  CLASS_CLOSE,\n  CLASS_FADE,\n  CLASS_FIXED,\n  CLASS_FULLSCREEN,\n  CLASS_HIDE,\n  CLASS_INVISIBLE,\n  DATA_ACTION,\n  EVENT_CLICK,\n  EVENT_LOAD,\n  EVENT_READY,\n  NAMESPACE,\n  WINDOW,\n} from './constants';\nimport {\n  addClass,\n  addListener,\n  assign,\n  dispatchEvent,\n  forEach,\n  getData,\n  getResponsiveClass,\n  hyphenate,\n  isFunction,\n  isNumber,\n  isPlainObject,\n  isString,\n  isUndefined,\n  removeListener,\n  setData,\n  setStyle,\n  toggleClass,\n} from './utilities';\n\nconst AnotherViewer = WINDOW.Viewer;\n\nclass Viewer {\n  /**\n   * Create a new Viewer.\n   * @param {Element} element - The target element for viewing.\n   * @param {Object} [options={}] - The configuration options.\n   */\n  constructor(element, options = {}) {\n    if (!element || element.nodeType !== 1) {\n      throw new Error('The first argument is required and must be an element.');\n    }\n\n    this.element = element;\n    this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n    this.action = false;\n    this.fading = false;\n    this.fulled = false;\n    this.hiding = false;\n    this.imageData = {};\n    this.index = 0;\n    this.isImg = false;\n    this.isShown = false;\n    this.length = 0;\n    this.played = false;\n    this.playing = false;\n    this.pointers = {};\n    this.ready = false;\n    this.showing = false;\n    this.timeout = false;\n    this.tooltipping = false;\n    this.viewed = false;\n    this.viewing = false;\n    this.wheeling = false;\n    this.zooming = false;\n    this.init();\n  }\n\n  init() {\n    const { element, options } = this;\n\n    if (getData(element, NAMESPACE)) {\n      return;\n    }\n\n    setData(element, NAMESPACE, this);\n\n    const isImg = element.tagName.toLowerCase() === 'img';\n    const images = [];\n\n    forEach(isImg ? [element] : element.querySelectorAll('img'), (image) => {\n      if (isFunction(options.filter)) {\n        if (options.filter.call(this, image)) {\n          images.push(image);\n        }\n      } else {\n        images.push(image);\n      }\n    });\n\n    if (!images.length) {\n      return;\n    }\n\n    this.isImg = isImg;\n    this.length = images.length;\n    this.images = images;\n\n    const { ownerDocument } = element;\n    const body = ownerDocument.body || ownerDocument.documentElement;\n\n    this.body = body;\n    this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n    this.initialBodyPaddingRight = window.getComputedStyle(body).paddingRight;\n\n    // Override `transition` option if it is not supported\n    if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n      options.transition = false;\n    }\n\n    if (options.inline) {\n      let count = 0;\n      const progress = () => {\n        count += 1;\n\n        if (count === this.length) {\n          let timeout;\n\n          this.initializing = false;\n          this.delaying = {\n            abort: () => {\n              clearTimeout(timeout);\n            },\n          };\n\n          // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n          timeout = setTimeout(() => {\n            this.delaying = false;\n            this.build();\n          }, 0);\n        }\n      };\n\n      this.initializing = {\n        abort() {\n          forEach(images, (image) => {\n            if (!image.complete) {\n              removeListener(image, EVENT_LOAD, progress);\n            }\n          });\n        },\n      };\n\n      forEach(images, (image) => {\n        if (image.complete) {\n          progress();\n        } else {\n          addListener(image, EVENT_LOAD, progress, {\n            once: true,\n          });\n        }\n      });\n    } else {\n      addListener(element, EVENT_CLICK, (this.onStart = ({ target }) => {\n        if (target.tagName.toLowerCase() === 'img') {\n          this.view(this.images.indexOf(target));\n        }\n      }));\n    }\n  }\n\n  build() {\n    if (this.ready) {\n      return;\n    }\n\n    const { element, options } = this;\n    const parent = element.parentNode;\n    const template = document.createElement('div');\n\n    template.innerHTML = TEMPLATE;\n\n    const viewer = template.querySelector(`.${NAMESPACE}-container`);\n    const title = viewer.querySelector(`.${NAMESPACE}-title`);\n    const toolbar = viewer.querySelector(`.${NAMESPACE}-toolbar`);\n    const navbar = viewer.querySelector(`.${NAMESPACE}-navbar`);\n    const button = viewer.querySelector(`.${NAMESPACE}-button`);\n    const canvas = viewer.querySelector(`.${NAMESPACE}-canvas`);\n\n    this.parent = parent;\n    this.viewer = viewer;\n    this.title = title;\n    this.toolbar = toolbar;\n    this.navbar = navbar;\n    this.button = button;\n    this.canvas = canvas;\n    this.footer = viewer.querySelector(`.${NAMESPACE}-footer`);\n    this.tooltipBox = viewer.querySelector(`.${NAMESPACE}-tooltip`);\n    this.player = viewer.querySelector(`.${NAMESPACE}-player`);\n    this.list = viewer.querySelector(`.${NAMESPACE}-list`);\n\n    addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(options.title));\n    addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n    toggleClass(button, CLASS_HIDE, !options.button);\n\n    if (options.backdrop) {\n      addClass(viewer, `${NAMESPACE}-backdrop`);\n\n      if (!options.inline && options.backdrop === true) {\n        setData(canvas, DATA_ACTION, 'hide');\n      }\n    }\n\n    if (options.toolbar) {\n      const list = document.createElement('ul');\n      const custom = isPlainObject(options.toolbar);\n      const zoomButtons = BUTTONS.slice(0, 3);\n      const rotateButtons = BUTTONS.slice(7, 9);\n      const scaleButtons = BUTTONS.slice(9);\n\n      if (!custom) {\n        addClass(toolbar, getResponsiveClass(options.toolbar));\n      }\n\n      forEach(custom ? options.toolbar : BUTTONS, (value, index) => {\n        const deep = custom && isPlainObject(value);\n        const name = custom ? hyphenate(index) : value;\n        const show = deep && !isUndefined(value.show) ? value.show : value;\n\n        if (\n          !show ||\n          (!options.zoomable && zoomButtons.indexOf(name) !== -1) ||\n          (!options.rotatable && rotateButtons.indexOf(name) !== -1) ||\n          (!options.scalable && scaleButtons.indexOf(name) !== -1)\n        ) {\n          return;\n        }\n\n        const size = deep && !isUndefined(value.size) ? value.size : value;\n        const click = deep && !isUndefined(value.click) ? value.click : value;\n        const item = document.createElement('li');\n\n        item.setAttribute('role', 'button');\n        addClass(item, `${NAMESPACE}-${name}`);\n\n        if (!isFunction(click)) {\n          setData(item, DATA_ACTION, name);\n        }\n\n        if (isNumber(show)) {\n          addClass(item, getResponsiveClass(show));\n        }\n\n        if (['small', 'large'].indexOf(size) !== -1) {\n          addClass(item, `${NAMESPACE}-${size}`);\n        } else if (name === 'play') {\n          addClass(item, `${NAMESPACE}-large`);\n        }\n\n        if (isFunction(click)) {\n          addListener(item, EVENT_CLICK, click);\n        }\n\n        list.appendChild(item);\n      });\n\n      toolbar.appendChild(list);\n    } else {\n      addClass(toolbar, CLASS_HIDE);\n    }\n\n    if (!options.rotatable) {\n      const rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n\n      addClass(rotates, CLASS_INVISIBLE);\n      forEach(rotates, (rotate) => {\n        toolbar.appendChild(rotate);\n      });\n    }\n\n    if (options.inline) {\n      addClass(button, CLASS_FULLSCREEN);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline,\n      });\n\n      if (window.getComputedStyle(parent).position === 'static') {\n        setStyle(parent, {\n          position: 'relative',\n        });\n      }\n\n      parent.insertBefore(viewer, element.nextSibling);\n    } else {\n      addClass(button, CLASS_CLOSE);\n      addClass(viewer, CLASS_FIXED);\n      addClass(viewer, CLASS_FADE);\n      addClass(viewer, CLASS_HIDE);\n\n      setStyle(viewer, {\n        zIndex: options.zIndex,\n      });\n\n      let { container } = options;\n\n      if (isString(container)) {\n        container = element.ownerDocument.querySelector(container);\n      }\n\n      if (!container) {\n        container = this.body;\n      }\n\n      container.appendChild(viewer);\n    }\n\n    if (options.inline) {\n      this.render();\n      this.bind();\n      this.isShown = true;\n    }\n\n    this.ready = true;\n\n    if (isFunction(options.ready)) {\n      addListener(element, EVENT_READY, options.ready, {\n        once: true,\n      });\n    }\n\n    if (dispatchEvent(element, EVENT_READY) === false) {\n      this.ready = false;\n      return;\n    }\n\n    if (this.ready && options.inline) {\n      this.view();\n    }\n  }\n\n  /**\n   * Get the no conflict viewer class.\n   * @returns {Viewer} The viewer class.\n   */\n  static noConflict() {\n    window.Viewer = AnotherViewer;\n    return Viewer;\n  }\n\n  /**\n   * Change the default options.\n   * @param {Object} options - The new default options.\n   */\n  static setDefaults(options) {\n    assign(DEFAULTS, isPlainObject(options) && options);\n  }\n}\n\nassign(Viewer.prototype, render, events, handlers, methods, others);\n\nexport default Viewer;\n"],"names":["inline","button","navbar","title","toolbar","tooltip","movable","zoomable","rotatable","scalable","transition","fullscreen","interval","keyboard","backdrop","loading","loop","minWidth","minHeight","zoomRatio","minZoomRatio","maxZoomRatio","zIndex","zIndexInline","url","container","filter","ready","show","shown","hide","hidden","view","viewed","zoom","zoomed","IN_BROWSER","window","WINDOW","NAMESPACE","ACTION_MOVE","ACTION_SWITCH","ACTION_ZOOM","CLASS_ACTIVE","CLASS_CLOSE","CLASS_FADE","CLASS_FIXED","CLASS_FULLSCREEN","CLASS_FULLSCREEN_EXIT","CLASS_HIDE","CLASS_HIDE_MD_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_XS_DOWN","CLASS_IN","CLASS_INVISIBLE","CLASS_LOADING","CLASS_MOVE","CLASS_OPEN","CLASS_SHOW","CLASS_TRANSITION","EVENT_READY","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_VIEW","EVENT_VIEWED","EVENT_ZOOM","EVENT_ZOOMED","EVENT_CLICK","EVENT_DRAG_START","EVENT_KEY_DOWN","EVENT_LOAD","EVENT_POINTER_DOWN","PointerEvent","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_RESIZE","EVENT_TRANSITION_END","EVENT_WHEEL","DATA_ACTION","BUTTONS","isString","value","isNaN","Number","isNumber","isUndefined","isObject","hasOwnProperty","Object","prototype","isPlainObject","constructor","call","e","isFunction","forEach","data","callback","Array","isArray","length","i","keys","key","assign","obj","args","arg","REGEXP_SUFFIX","setStyle","element","styles","style","property","test","hasClass","classList","contains","className","indexOf","addClass","elem","add","trim","removeClass","remove","replace","toggleClass","added","REGEXP_HYPHENATE","hyphenate","toLowerCase","getData","name","dataset","getAttribute","setData","setAttribute","removeData","undefined","removeAttribute","REGEXP_SPACES","onceSupported","supported","once","listener","options","defineProperty","get","set","addEventListener","removeEventListener","removeListener","type","handler","split","event","listeners","addListener","apply","dispatchEvent","Event","CustomEvent","detail","bubbles","cancelable","document","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","documentElement","clientLeft","top","pageYOffset","clientTop","getTransforms","rotate","scaleX","scaleY","translateX","translateY","values","push","transform","join","WebkitTransform","msTransform","getImageNameFromURL","IS_SAFARI","navigator","userAgent","getImageNaturalSizes","image","newImage","createElement","naturalWidth","naturalHeight","body","onload","width","height","removeChild","src","cssText","appendChild","getResponsiveClass","getMaxZoomRatio","pointers","pointers2","ratios","pointer","pointerId","pointer2","x1","Math","abs","startX","y1","startY","x2","endX","y2","endY","z1","sqrt","z2","ratio","sort","a","b","getPointer","endOnly","pageX","pageY","end","getPointersCenter","count","render","initContainer","initViewer","initList","renderViewer","containerData","innerWidth","innerHeight","parent","viewerData","max","offsetWidth","offsetHeight","parentData","fulled","viewer","list","items","images","alt","innerHTML","getElementsByTagName","item","firstElementChild","loadImage","renderList","index","outerWidth","resetList","initImage","done","footerHeight","footer","viewerWidth","viewerHeight","oldImageData","imageData","sizingImage","imageInitializing","abort","aspectRatio","min","initialImageData","renderImage","marginLeft","marginTop","viewing","zooming","onTransitionEnd","imageRendering","resetImage","parentNode","bind","onClick","click","onWheel","wheel","onDragStart","dragstart","canvas","onPointerDown","pointerdown","ownerDocument","onPointerMove","pointermove","onPointerUp","pointerup","onKeyDown","keydown","onResize","resize","unbind","target","action","played","stop","exit","full","toggle","reset","prev","play","next","load","timeout","clearTimeout","originalImage","parentWidth","parentHeight","filled","keyCode","which","charCode","preventDefault","ctrlKey","tagName","showing","hiding","changedTouches","touch","identifier","pointerType","isSwitchable","change","isShown","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","player","wheeling","setTimeout","delta","deltaY","wheelDelta","immediate","build","transitioning","open","zoomTo","img","querySelector","onViewed","textContent","onLoad","complete","maxIndex","move","offsetX","offsetY","moveTo","x","y","changed","hasTooltip","_originalEvent","_zoomable","newWidth","newHeight","oldRatio","originalEvent","offset","center","degree","rotateTo","scale","total","onLoadWhenPlay","requestFullscreen","playing","exitFullscreen","close","tooltipBox","round","tooltipping","fading","update","isImg","destroy","querySelectorAll","indexes","destroyed","delaying","initializing","onStart","paddingRight","scrollbarWidth","parseFloat","initialBodyPaddingRight","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","absoluteOffsetX","p","AnotherViewer","Viewer","nodeType","Error","DEFAULTS","init","clientWidth","getComputedStyle","progress","template","TEMPLATE","custom","zoomButtons","slice","rotateButtons","scaleButtons","deep","size","rotates","position","insertBefore","nextSibling","events","handlers","methods","others"],"mappings":"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"}